# JVM整体结构

## 一图胜千言

![](https://i.loli.net/2020/07/09/zn9rS4ZmvtB8GIE.png)


## Java代码执行流程

![](https://i.loli.net/2020/07/09/vpYNeDhXZyCER7A.png)

- Java编译器（前端编译器）生成字节码文件
  - 如果任何一个环节失败了都不会正确生成字节码文件
- JVM执行字节码文件，不论是什么语言，只要遵循了JVM规范都可以被JVM执行。
- 操作系统只能执行机器指令，上图的执行引擎将字节码文件转换为机器指令供操作系统执行。
- 解释执行是用来保证执行时间的，逐行针对字节码指令来进行执行。
- JIT编译器针对字节码指令中要反复执行的“热点代码”，JIT会直接把它编译成机器指令，放在方法区中，并且将它缓存起来。

# JVM的架构模型

**JVM编译器输入的指令流基本上是一种基于栈的指令集架构，另外一种指令集架构是基于寄存器的指令集架构**

## 两者的区别是

### 基于栈的架构的特点：

1. 设计和实现更简单，适用于资源受限的系统;
2. 避开了寄存器的分配难题:使用零地址指令方式分配。
3. 指令流中的指令大部分是零地址指令，其执行过程依赖于操作栈。指令集更小，编译器容易实现。
4. 不需要硬件支持，可移植性更好，更好实现跨平台

### 基于寄存器架构的特点
1. 典型的应用是x86的二进制指令集:比如传统的PC以及Android的Davlik虛拟机。
2. 指令集架构则完全依赖硬件，可移植性差
3. 性能优秀和执行更高效;
4. 花费更少的指令去完成一项操作。
5. 在大部分情况下，基于寄存器架构的指令集往往都以一地址指令、二地址指令和三地址指令为主，而基于栈式架构的指令集却是以零地址指令为主。