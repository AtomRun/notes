# 订单校验要考虑的若干种校验项

1. **商品** 是否有货？
2. **商品** 最大购买数量
   1. 对用户一次性购买的订单数量有总数限制：例如一次订单最多购买100哥商品
   2. 对某个SKU有数量限制，例如一次只能买5件
3. **totalPrice**  原价和客户端提交的是否相同？
4. **finalPrice** 折扣价和前端相关的是否相同
5. 优惠券
   1. 判断用户是否拥有优惠券，不能随便输入couponId，就能拥有优惠券
   2. 优惠券是否过期

# Spring注入的实例的都是单例的，singleton

单例模式有什么缺陷？

CouponChecker是单例模式的缺陷，spring默认注入的实例都是单例的。

CouponChecker的最大缺陷是不能在类下直接写成员变量，没有意义的。

例如每次有一个请求进来，我们希望有一个新的CouponChecker出现，如果全局只有一个CouponChecker，那么checker中的coupon和userCoupon代表的是哪一个用户呢，所以我们必须要多例的couponChecker，用来保存checker中独立的数据。

如果是单例的模式，每个请求修改的都是同一份数据。

# 价格参数

1. 前端计算的原价
2. 前端计算的折扣价（折扣价）
3. 服务端计算的原价
4. 服务端计算的折扣价

前端要和后端做对比，服务端需要自己计算，而不是直接使用前端的价格，所有价格进行比对，没有问题了再进行下一步的操作。