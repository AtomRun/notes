# 避免数据库库存变成负数

## 1.java代码加锁

## 2. 数据库强行加锁

悲观锁

1. 开启事务，事务没有完成就一直有锁
2. 进行查询，查询当前sku，读取sku的stock
3. 满足的话更新库存
4. 提交事务

不建议，高并发情况下加锁解锁，消耗数据库资源

## 乐观锁

没有一个实际意义的锁，是并发竟态的一种思想